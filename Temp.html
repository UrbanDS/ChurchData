<!DOCTYPE html>
<head>    
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    
        <script>
            L_NO_TOUCH = false;
            L_DISABLE_3D = false;
        </script>
    
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.5.1/dist/leaflet.js"></script>
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.5.1/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css"/>
    <link rel="stylesheet" href="https://rawcdn.githack.com/python-visualization/folium/master/folium/templates/leaflet.awesome.rotate.css"/>
    <style>html, body {width: 100%;height: 100%;margin: 0;padding: 0;}</style>
    <style>#map {position:absolute;top:0;bottom:0;right:0;left:0;}</style>
    
            <meta name="viewport" content="width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
            <style>
                #map_6c2c04f8943942178b16c00bce248dbc {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
            </style>
        
    <script src="https://rawcdn.githack.com/nezasa/iso8601-js-period/master/iso8601.min.js"></script>
    <script src="https://rawcdn.githack.com/socib/Leaflet.TimeDimension/master/dist/leaflet.timedimension.min.js"></script>
    <script src="https://rawcdn.githack.com/python-visualization/folium/master/folium/templates/pa7_hm.min.js"></script>
    <script src="https://rawcdn.githack.com/pa7/heatmap.js/develop/plugins/leaflet-heatmap/leaflet-heatmap.js"></script>
    <link rel="stylesheet" href="http://apps.socib.es/Leaflet.TimeDimension/dist/leaflet.timedimension.control.min.css"/>
    
            <script>
                var TDHeatmap = L.TimeDimension.Layer.extend({

            initialize: function(data, options) {
                var heatmapCfg = {
                    radius: 15,
                    maxOpacity: 1.,
                    scaleRadius: false,
                    useLocalExtrema: false,
                    latField: 'lat',
                    lngField: 'lng',
                    valueField: 'count',
                    defaultWeight : 1,
                };
                heatmapCfg = $.extend({}, heatmapCfg, options.heatmapOptions || {});
                var layer = new HeatmapOverlay(heatmapCfg);
                L.TimeDimension.Layer.prototype.initialize.call(this, layer, options);
                this._currentLoadedTime = 0;
                this._currentTimeData = {
                    data: []
                    };
                this.data= data;
                this.defaultWeight = heatmapCfg.defaultWeight || 1;
            },
            onAdd: function(map) {
                L.TimeDimension.Layer.prototype.onAdd.call(this, map);
                map.addLayer(this._baseLayer);
                if (this._timeDimension) {
                    this._getDataForTime(this._timeDimension.getCurrentTime());
                }
            },
            _onNewTimeLoading: function(ev) {
                this._getDataForTime(ev.time);
                return;
            },
            isReady: function(time) {
                return (this._currentLoadedTime == time);
            },
            _update: function() {
                this._baseLayer.setData(this._currentTimeData);
                return true;
            },
            _getDataForTime: function(time) {
                    delete this._currentTimeData.data;
                    this._currentTimeData.data = [];
                    var data = this.data[time-1];
                    for (var i = 0; i < data.length; i++) {
                        this._currentTimeData.data.push({
                                lat: data[i][0],
                                lng: data[i][1],
                                count: data[i].length>2 ? data[i][2] : this.defaultWeight
                            });
                        }
                    this._currentLoadedTime = time;
                    if (this._timeDimension && time == this._timeDimension.getCurrentTime() && !this._timeDimension.isLoading()) {
                        this._update();
                    }
                    this.fire('timeload', {
                        time: time
                    });
                }
        });

        L.Control.TimeDimensionCustom = L.Control.TimeDimension.extend({
            initialize: function(index, options) {
                var playerOptions = {
                    buffer: 1,
                    minBufferReady: -1
                    };
                options.playerOptions = $.extend({}, playerOptions, options.playerOptions || {});
                L.Control.TimeDimension.prototype.initialize.call(this, options);
                this.index = index;
                },
            _getDisplayDateFormat: function(date){
                return this.index[date.getTime()-1];
                }
            });
            </script>
                
</head>
<body>    
    
            <div class="folium-map" id="map_6c2c04f8943942178b16c00bce248dbc" ></div>
        
</body>
<script>    
    
            var map_6c2c04f8943942178b16c00bce248dbc = L.map(
                "map_6c2c04f8943942178b16c00bce248dbc",
                {
                    center: [41.9028, 12.4964],
                    crs: L.CRS.EPSG3857,
                    zoom: 13,
                    zoomControl: true,
                    preferCanvas: false,
                }
            );

            

        
    
            var tile_layer_7899851ff1af443ab64aaaf487b775d7 = L.tileLayer(
                "https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png",
                {"attribution": "\u0026copy; \u003ca href=\"http://www.openstreetmap.org/copyright\"\u003eOpenStreetMap\u003c/a\u003e contributors \u0026copy; \u003ca href=\"http://cartodb.com/attributions\"\u003eCartoDB\u003c/a\u003e, CartoDB \u003ca href =\"http://cartodb.com/attributions\"\u003eattributions\u003c/a\u003e", "detectRetina": false, "maxNativeZoom": 18, "maxZoom": 18, "minZoom": 0, "noWrap": false, "opacity": 1, "subdomains": "abc", "tms": false}
            ).addTo(map_6c2c04f8943942178b16c00bce248dbc);
        
    

            var times = [1, 2, 3, 4, 5, 6, 7, 8];

            map_6c2c04f8943942178b16c00bce248dbc.timeDimension = L.timeDimension(
                {times : times, currentTime: new Date(1)}
            );

            var heat_map_022801fabcbe4041885bcb8e1404247fControl = new L.Control.TimeDimensionCustom([13, 14, 16, 17, 18, 19, 20, 21], {
                autoPlay: false,
                backwardButton: true,
                displayDate: true,
                forwardButton: true,
                limitMinimumRange: 5,
                limitSliders: true,
                loopButton: true,
                maxSpeed: 10,
                minSpeed: 0.1,
                playButton: true,
                playReverseButton: true,
                position: "topright",
                speedSlider: true,
                speedStep: 0.1,
                styleNS: "leaflet-control-timecontrol",
                timeSlider: true,
                timeSliderDrapUpdate: false,
                timeSteps: 1
                })
                .addTo(map_6c2c04f8943942178b16c00bce248dbc);

                var heat_map_022801fabcbe4041885bcb8e1404247f = new TDHeatmap([[[41.888753, 12.498028]], [[41.889542, 12.469799]], [[41.891443, 12.470165], [41.89376, 12.47263], [41.895986, 12.472242], [41.89825, 12.4694], [41.901517999999996, 12.472737], [41.907906, 12.482275]], [[41.886601, 12.474813000000001], [41.891505, 12.483360000000001], [41.895403, 12.473711999999999], [41.896791, 12.474527], [41.896811, 12.496984], [41.896937, 12.468642], [41.89725, 12.477951], [41.898484, 12.477547999999999], [41.899147, 12.468616], [41.899812, 12.467611], [41.899966, 12.483891999999999], [41.900063, 12.472984], [41.90096, 12.47061], [41.902281, 12.476044], [41.90426, 12.457581]], [[41.87678, 12.50205], [41.877541, 12.475996], [41.887375, 12.47686], [41.888220000000004, 12.47107], [41.888851, 12.475645], [41.888925, 12.498091], [41.889071, 12.471167999999999], [41.889720000000004, 12.47287], [41.889928999999995, 12.469646000000001], [41.891486, 12.469844], [41.892764, 12.478926], [41.892959999999995, 12.48911], [41.892986, 12.489281], [41.89305, 12.48937], [41.893122999999996, 12.488097], [41.893386, 12.488535], [41.893933000000004, 12.492412], [41.894151, 12.479913], [41.894337, 12.487252], [41.894356, 12.478327], [41.894444, 12.487065], [41.89492, 12.49263], [41.89501, 12.472389999999999], [41.895067, 12.474097], [41.895297, 12.471293], [41.895512, 12.473123], [41.89578, 12.494439999999999], [41.895819, 12.477822999999999], [41.895842, 12.478355], [41.895964, 12.473552], [41.89606, 12.47288], [41.89615, 12.49724], [41.896628, 12.474153999999999], [41.896656, 12.468746000000001], [41.896665999999996, 12.478827], [41.897056, 12.468473], [41.897201, 12.473443], [41.897366999999996, 12.476367], [41.897414000000005, 12.473111], [41.89756, 12.49747], [41.89761, 12.47359], [41.89822, 12.46142], [41.898505, 12.469463000000001], [41.898508, 12.475846], [41.899269, 12.479463], [41.89966, 12.48278], [41.899694000000004, 12.4806], [41.899809000000005, 12.476053], [41.9, 12.476719000000001], [41.900098, 12.479273], [41.900496000000004, 12.475897999999999], [41.900503, 12.470289], [41.900529999999996, 12.47403], [41.901161, 12.460844999999999], [41.90125, 12.47537], [41.902906, 12.483296000000001], [41.903421, 12.460372999999999], [41.903473, 12.48671], [41.903495, 12.476457], [41.903636, 12.461986999999999], [41.903725, 12.482567999999999], [41.90376, 12.48662], [41.903942, 12.461707], [41.90428, 12.48777], [41.90513, 12.48676], [41.905809999999995, 12.47828], [41.905879999999996, 12.48099], [41.906036, 12.483613], [41.90703, 12.477219999999999], [41.923811, 12.502797]], [[41.877456, 12.475928999999999], [41.886438, 12.47693], [41.88856, 12.476719000000001], [41.88883, 12.450289999999999], [41.88921, 12.47585], [41.88925, 12.477064], [41.889897999999995, 12.473001], [41.889995, 12.466619999999999], [41.890116, 12.469906], [41.890503, 12.468649000000001], [41.891346, 12.468717], [41.89136, 12.468589999999999], [41.891833, 12.468850999999999], [41.89304, 12.50201], [41.893190000000004, 12.478552], [41.893246000000005, 12.472074000000001], [41.893446000000004, 12.479144], [41.893809999999995, 12.48954], [41.893868, 12.475171000000001], [41.894009999999994, 12.481069999999999], [41.89411, 12.47971], [41.89425, 12.469439999999999], [41.894422, 12.48082], [41.894746000000005, 12.471356], [41.894952, 12.501439999999999], [41.89516, 12.48077], [41.895205, 12.497126], [41.895441, 12.486912], [41.895899, 12.489002000000001], [41.896306, 12.480215], [41.896522999999995, 12.480774], [41.897129, 12.477992], [41.897335999999996, 12.468618], [41.89777, 12.461310000000001], [41.899029999999996, 12.47582], [41.899157, 12.471956], [41.899263, 12.468430999999999], [41.899303, 12.500836999999999], [41.89953, 12.4707], [41.89965, 12.4715], [41.89969, 12.465563000000001], [41.900074, 12.47182], [41.900432, 12.472178], [41.90047, 12.476536999999999], [41.900476, 12.469846], [41.900562, 12.48368], [41.900816, 12.475959], [41.900825, 12.481752], [41.901076, 12.479467], [41.90145, 12.494497], [41.901610999999995, 12.458907], [41.901790999999996, 12.481860000000001], [41.901913, 12.4952], [41.902938, 12.480471000000001], [41.903308, 12.504967], [41.903863, 12.505778], [41.903938000000004, 12.4843], [41.904037, 12.457825], [41.904191, 12.478054], [41.904579999999996, 12.477039999999999], [41.904720000000005, 12.47892], [41.904759999999996, 12.46112], [41.905136, 12.473249000000001], [41.905319, 12.48664], [41.905662, 12.462558999999999], [41.90602, 12.46687], [41.906591999999996, 12.45778], [41.906779, 12.495500999999999], [41.907625, 12.476948], [41.9077, 12.4781], [41.90807, 12.47947], [41.90825, 12.489367999999999], [41.90826, 12.48837], [41.908592, 12.488218], [41.908809000000005, 12.477160000000001], [41.908949, 12.479203], [41.909323, 12.477888], [41.909836999999996, 12.477264], [41.91107, 12.467888], [41.911171, 12.468335], [41.914753000000005, 12.49405]], [[41.855164, 12.481488], [41.86616, 12.594741], [41.870405, 12.470628999999999], [41.872479999999996, 12.44957], [41.875797999999996, 12.521435], [41.876006, 12.487666], [41.877793, 12.452661], [41.878498, 12.460694], [41.879088, 12.485211999999999], [41.87925, 12.49669], [41.882306, 12.522072999999999], [41.882439, 12.513678], [41.882779, 12.543166000000001], [41.88285, 12.543122], [41.882915000000004, 12.483697], [41.883241999999996, 12.541797], [41.88333, 12.543163], [41.884243, 12.460796], [41.884303, 12.524363000000001], [41.884658, 12.470555000000001], [41.884887, 12.530153], [41.884892, 12.530275], [41.884902000000004, 12.530145], [41.884977, 12.521305], [41.885290999999995, 12.523724000000001], [41.885715999999995, 12.53351], [41.885983, 12.521892], [41.886010999999996, 12.522519], [41.886022, 12.521853], [41.886133, 12.517214], [41.886524, 12.515406], [41.887908, 12.513369], [41.887938, 12.504235000000001], [41.888481, 12.529746000000001], [41.889075, 12.525763000000001], [41.889348999999996, 12.476146], [41.889790000000005, 12.47586], [41.890669, 12.483467], [41.891069, 12.521106], [41.891441, 12.527158], [41.89206, 12.476569999999999], [41.892309999999995, 12.50949], [41.892340000000004, 12.48703], [41.892917, 12.541628], [41.89306, 12.51205], [41.893068, 12.57664], [41.893268, 12.479593], [41.89338, 12.47226], [41.89346, 12.48967], [41.893494, 12.473877], [41.893753000000004, 12.478448], [41.893947, 12.477443], [41.894646, 12.470001], [41.894737, 12.477495], [41.894875, 12.49045], [41.89545, 12.509310000000001], [41.89547, 12.490395], [41.895674, 12.428723], [41.895872999999995, 12.500461], [41.89606, 12.468689999999999], [41.896152, 12.496377], [41.896184000000005, 12.418556], [41.896443, 12.46364], [41.896466, 12.49429], [41.896564, 12.47245], [41.896781, 12.469904], [41.896792, 12.475802], [41.896876, 12.494655999999999], [41.897371, 12.479398], [41.89778, 12.461310000000001], [41.898163000000004, 12.489132000000001], [41.898456, 12.482624000000001], [41.89905, 12.48428], [41.899648, 12.494703], [41.900164000000004, 12.495495], [41.901008000000004, 12.4923], [41.90122, 12.46787], [41.901362, 12.460656], [41.902506, 12.473343], [41.902590000000004, 12.482560000000001], [41.903095, 12.475096], [41.9031, 12.462133999999999], [41.90339, 12.463098], [41.90354, 12.47841], [41.903937, 12.485519], [41.904353, 12.482064999999999], [41.90436, 12.458796000000001], [41.90468, 12.485899], [41.904742, 12.493985], [41.90482, 12.48576], [41.905451, 12.457908], [41.90586, 12.487189], [41.906612, 12.514297000000001], [41.907011, 12.487855999999999], [41.907243, 12.462707], [41.907561, 12.488731], [41.908059, 12.451645], [41.90869, 12.46532], [41.908705, 12.506755], [41.90871, 12.45532], [41.908749, 12.477852], [41.909562, 12.488842], [41.90961, 12.470460000000001], [41.910193, 12.4500939], [41.910405, 12.465477], [41.911190999999995, 12.494358], [41.911411, 12.509235], [41.911584000000005, 12.50918], [41.911770000000004, 12.492560000000001], [41.912588, 12.496032000000001], [41.913278999999996, 12.469826], [41.913305, 12.499738], [41.915558000000004, 12.456196], [41.915869, 12.46258], [41.915963, 12.496914], [41.916579999999996, 12.457265], [41.918332, 12.45604], [41.918579, 12.501308], [41.91961, 12.47894], [41.91972, 12.460942999999999], [41.921645, 12.505096], [41.921695, 12.483694999999999], [41.923085, 12.513159], [41.925406, 12.464037], [41.927345, 12.511097]], [[41.862255, 12.542919], [41.88373, 12.535489], [41.886144, 12.463008], [41.887799, 12.532022], [41.893886, 12.472465]]],
                {heatmapOptions: {
                        radius: 15,
                        minOpacity: 0,
                        maxOpacity: 0.6,
                        scaleRadius: false,
                        useLocalExtrema: false,
                        defaultWeight: 1,
                        
                    }
                })
                .addTo(map_6c2c04f8943942178b16c00bce248dbc);

        
</script>